dnl 
dnl   Copyright 2001, 2005 Adrian Thurston <thurston@complang.org>
dnl

dnl   This file is part of Kelbt.
dnl  
dnl   Kelbt is free software; you can redistribute it and/or modify
dnl   it under the terms of the GNU General Public License as published by
dnl   the Free Software Foundation; either version 2 of the License, or
dnl   (at your option) any later version.
dnl   
dnl   Kelbt is distributed in the hope that it will be useful,
dnl   but WITHOUT ANY WARRANTY; without even the implied warranty of
dnl   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
dnl   GNU General Public License for more details.
dnl   
dnl   You should have received a copy of the GNU General Public License
dnl   along with Kelbt; if not, write to the Free Software
dnl   Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA 
  
AC_INIT(kelbt, 0.16)
PUBDATE="February 2015"

AM_INIT_AUTOMAKE([foreign])
AC_SUBST(PUBDATE)
AC_CONFIG_HEADER(src/config.h)

: ${CFLAGS="-Wall -g"}
: ${CXXFLAGS="-Wall -g"}

dnl Choose a default for the build_parsers. If the dist
dnl file is present in the root then use it's contents,
dnl otherwise default to yes.
AS_IF([test -r $srcdir/DIST], [. $srcdir/DIST], [build_parsers=yes;])
AM_CONDITIONAL(BUILD_PARSERS, [test "x$build_parsers" = "xyes"])

if test "x$build_parsers" = "xyes"; then
	AC_CHECK_PROG(RAGEL, ragel, ragel)
	if test -z "$RAGEL"; then
		echo
		echo "error: ragel is required to build the parsers"
		echo
		exit 1
	fi

	AC_CHECK_PROG(KELBT, kelbt, kelbt)
	if test -z "$KELBT"; then
		echo
		echo "error: kelbt is required to build the parsers"
		echo
		exit 1
	fi
fi

dnl Checks for programs.
AC_PROG_CXX
dnl AC_DEFINE_UNQUOTED(CXX,$CXX)

dnl dnl Set test on c++ compiler.
dnl AC_LANG_CPLUSPLUS

dnl dnl Check for definition of MAKE.
dnl AC_PROG_MAKE_SET

dnl dnl write output files
dnl AC_OUTPUT(Makefile kelbt/Makefile)

AC_OUTPUT([
		Makefile
		src/Makefile
		aapl/Makefile
])

echo "configuration of kelbt complete"
